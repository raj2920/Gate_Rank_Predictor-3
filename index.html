<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="google-site-verification" content="iLnn73OYPE8oGpGt16HX4ooi_DyK4Q52wTCGQ96SDfc" />
    <meta name="description" content="Accurate GATE 2026 Rank Predictor based on actual GATE data. Check expected rank, score vs marks, and cutoff analysis for all branches.">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-5B7D2R8VD0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-5B7D2R8VD0');
</script>
    <title>GATE Rank Predictor 2026 | Predict Your Rank, Score & IIT/PSU Chances Instantly</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        /* 3D Enhanced UI with Crisp Text - Zoomed Out */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --success: #27ae60;
            --warning: #f39c12;
            --danger: #e74c3c;
        }

        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #333;
            line-height: 1.5;
            min-height: 100vh;
            padding: 15px;
            font-size: 14px;
        }

        .container {
            width: 98%;
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Header with 3D effect */
        header {
            background: linear-gradient(135deg, var(--primary), #1a2634);
            color: white;
            padding: 20px 30px;
            text-align: center;
            position: relative;
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
            border-bottom: 2px solid rgba(255,255,255,0.1);
        }

        .logo {
            display: inline-flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 5px;
            transition: transform 0.3s ease;
        }

        .logo:hover {
            transform: scale(1.02);
        }

        .logo i {
            font-size: 2.2rem;
            color: var(--secondary);
            background: white;
            padding: 10px;
            border-radius: 50%;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            border: 1px solid rgba(255,255,255,0.3);
        }

        .logo h1 {
            font-size: 1.8rem;
            font-weight: 700;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .logo span {
            color: var(--secondary);
        }

        .subtitle {
            font-size: 1rem;
            opacity: 0.95;
            color: #ecf0f1;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
            -webkit-font-smoothing: antialiased;
            margin-top: 3px;
        }

        /* Main Content */
        .main-content {
            padding: 30px;
        }

        /* Input Section */
        .input-section {
            background: #f8f9fa;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            border: 1px solid #e0e0e0;
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
        }

        .input-section:hover {
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }

        .section-toggle {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            margin-bottom: 20px;
        }

        .section-toggle h2 {
            color: var(--primary);
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 12px;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.1);
            -webkit-font-smoothing: antialiased;
        }

        .marks-type {
            background: white;
            padding: 20px;
            border-radius: 16px;
            margin-bottom: 20px;
            border: 1px solid #e0e0e0;
            box-shadow: 0 8px 20px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
        }

        .marks-type:hover {
            box-shadow: 0 15px 30px rgba(0,0,0,0.12);
        }

        .marks-type h4 {
            color: var(--primary);
            margin-bottom: 16px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 8px;
            border-bottom: 1px solid var(--secondary);
            padding-bottom: 8px;
            -webkit-font-smoothing: antialiased;
        }

        .marks-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        @media (max-width: 768px) {
            .marks-grid {
                grid-template-columns: 1fr;
            }
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .input-group label {
            font-weight: 600;
            color: #555;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            -webkit-font-smoothing: antialiased;
        }

        .input-group input, .input-group select {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 0.95rem;
            transition: all 0.3s;
            background: white;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
            -webkit-font-smoothing: antialiased;
        }

        .input-group input:focus, .input-group select:focus {
            border-color: var(--secondary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1), inset 0 1px 3px rgba(0,0,0,0.05);
        }

        .category-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin: 15px 0;
        }

        @media (max-width: 600px) {
            .category-buttons {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .category-btn {
            padding: 12px;
            background: #f0f0f0;
            border: 1px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            text-align: center;
            transition: all 0.3s;
            box-shadow: 0 3px 8px rgba(0,0,0,0.08);
            -webkit-font-smoothing: antialiased;
        }

        .category-btn:hover {
            background: #e0e0e0;
            transform: scale(1.01);
            box-shadow: 0 6px 15px rgba(0,0,0,0.1);
        }

        .category-btn.active {
            background: var(--secondary);
            color: white;
            border-color: var(--secondary);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
        }

        .quick-buttons {
            display: flex;
            gap: 8px;
            margin-top: 8px;
            flex-wrap: wrap;
        }

        .quick-btn {
            padding: 6px 12px;
            background: #f0f0f0;
            border: 1px solid #ddd;
            border-radius: 16px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.08);
            -webkit-font-smoothing: antialiased;
        }

        .quick-btn:hover {
            background: #e0e0e0;
            transform: scale(1.02);
            box-shadow: 0 4px 10px rgba(0,0,0,0.12);
        }

        .quick-btn.active {
            background: var(--secondary);
            color: white;
            border-color: var(--secondary);
        }

        .predict-container {
            text-align: center;
            margin: 30px 0;
        }

        .predict-btn {
            background: linear-gradient(135deg, var(--secondary), #2980b9);
            color: white;
            border: none;
            padding: 16px 40px;
            border-radius: 40px;
            font-size: 1.3rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 15px 30px rgba(52, 152, 219, 0.3);
            border: 1px solid rgba(255,255,255,0.2);
            -webkit-font-smoothing: antialiased;
        }

        .predict-btn:hover {
            transform: scale(1.03);
            box-shadow: 0 20px 40px rgba(52, 152, 219, 0.4);
        }

        .predict-btn:active {
            transform: scale(0.99);
        }

        .check-again-btn {
            background: linear-gradient(135deg, var(--warning), #e67e22);
            color: white;
            border: none;
            padding: 14px 30px;
            border-radius: 40px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 12px 25px rgba(243, 156, 18, 0.3);
            border: 1px solid rgba(255,255,255,0.2);
            -webkit-font-smoothing: antialiased;
        }

        .check-again-btn:hover {
            transform: scale(1.03);
            box-shadow: 0 15px 30px rgba(243, 156, 18, 0.4);
        }

        .results-section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-top: 25px;
            display: none;
            border: 1px solid var(--secondary);
            animation: slideIn 0.5s ease;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }

        @keyframes slideIn {
            0% {
                opacity: 0;
                transform: translateY(-15px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .results-section.visible {
            display: block;
        }

        .results-header {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
        }

        .results-header h2 {
            color: var(--primary);
            font-size: 1.8rem;
            margin-bottom: 10px;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.1);
            -webkit-font-smoothing: antialiased;
        }

        .qualification-status {
            text-align: center;
            margin: 25px 0;
            padding: 20px;
            border-radius: 16px;
            transition: all 0.3s;
        }

        .qualification-status:hover {
            box-shadow: 0 15px 30px rgba(0,0,0,0.08);
        }

        .qualified {
            background: linear-gradient(135deg, rgba(39, 174, 96, 0.1), rgba(39, 174, 96, 0.05));
            border: 2px solid var(--success);
            box-shadow: 0 10px 20px rgba(39, 174, 96, 0.15);
        }

        .not-qualified {
            background: linear-gradient(135deg, rgba(231, 76, 60, 0.1), rgba(231, 76, 60, 0.05));
            border: 2px solid var(--danger);
            box-shadow: 0 10px 20px rgba(231, 76, 60, 0.15);
        }

        .status-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .status-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 12px;
            -webkit-font-smoothing: antialiased;
        }

        .status-details {
            font-size: 1rem;
            color: #555;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
        }

        .iit-admission {
            background: linear-gradient(135deg, #e8f6f3, #d1f2eb);
            padding: 25px;
            border-radius: 16px;
            margin: 25px 0;
            border-left: 6px solid #1abc9c;
            box-shadow: 0 12px 25px rgba(26, 188, 156, 0.15);
            transition: all 0.3s;
        }

        .iit-admission:hover {
            box-shadow: 0 20px 40px rgba(26, 188, 156, 0.2);
        }

        .iit-admission h4 {
            color: #0e6251;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1.2rem;
            -webkit-font-smoothing: antialiased;
        }

        .iit-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 15px;
        }

        @media (max-width: 768px) {
            .iit-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .iit-grid {
                grid-template-columns: 1fr;
            }
        }

        .iit-card {
            background: white;
            padding: 20px;
            border-radius: 14px;
            text-align: center;
            border-top: 4px solid #1abc9c;
            box-shadow: 0 8px 18px rgba(0, 0, 0, 0.08);
            transition: all 0.3s;
        }

        .iit-card:hover {
            transform: scale(1.01);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.12);
        }

        .iit-card h5 {
            color: #0e6251;
            margin-bottom: 8px;
            font-size: 1rem;
            -webkit-font-smoothing: antialiased;
        }

        .iit-marks {
            font-size: 1.3rem;
            font-weight: 700;
            color: #1abc9c;
            margin: 8px 0;
            -webkit-font-smoothing: antialiased;
        }

        .iit-type {
            font-size: 0.8rem;
            color: #666;
            -webkit-font-smoothing: antialiased;
        }

        .analysis-box {
            background: linear-gradient(135deg, #fff8e1, #ffeaa7);
            padding: 25px;
            border-radius: 16px;
            margin: 25px 0;
            border-left: 6px solid var(--warning);
            box-shadow: 0 12px 25px rgba(243, 156, 18, 0.15);
            transition: all 0.3s;
        }

        .analysis-box:hover {
            box-shadow: 0 20px 40px rgba(243, 156, 18, 0.2);
        }

        .analysis-box h4 {
            color: var(--primary);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
            -webkit-font-smoothing: antialiased;
        }

        .analysis-text {
            font-size: 1rem;
            line-height: 1.6;
            color: #2c3e50;
            -webkit-font-smoothing: antialiased;
        }

        .excellent {
            color: var(--success);
            font-weight: 700;
        }

        .good {
            color: #3498db;
            font-weight: 700;
        }

        .average {
            color: var(--warning);
            font-weight: 700;
        }

        .improve {
            color: var(--danger);
            font-weight: 700;
        }

        .psu-section {
            background: linear-gradient(135deg, #fff0e1, #ffe3b3);
            padding: 25px;
            border-radius: 16px;
            margin: 25px 0;
            border-left: 6px solid #e67e22;
            box-shadow: 0 12px 25px rgba(230, 126, 34, 0.15);
            transition: all 0.3s;
        }

        .psu-section:hover {
            box-shadow: 0 20px 40px rgba(230, 126, 34, 0.2);
        }

        .psu-section h4 {
            color: #7d6608;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1.2rem;
            -webkit-font-smoothing: antialiased;
        }

        .psu-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 15px;
        }

        @media (max-width: 768px) {
            .psu-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .psu-grid {
                grid-template-columns: 1fr;
            }
        }

        .psu-card {
            background: white;
            padding: 20px;
            border-radius: 14px;
            text-align: center;
            border-top: 4px solid #e67e22;
            box-shadow: 0 8px 18px rgba(0, 0, 0, 0.08);
            transition: all 0.3s;
        }

        .psu-card:hover {
            transform: scale(1.01);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.12);
        }

        .psu-card h5 {
            color: #7d6608;
            margin-bottom: 8px;
            font-size: 1rem;
            -webkit-font-smoothing: antialiased;
        }

        .psu-chance {
            font-size: 1.3rem;
            font-weight: 700;
            color: #e67e22;
            margin: 8px 0;
            -webkit-font-smoothing: antialiased;
        }

        .psu-companies {
            font-size: 0.8rem;
            color: #666;
            -webkit-font-smoothing: antialiased;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 25px;
        }

        @media (max-width: 768px) {
            .results-grid {
                grid-template-columns: 1fr;
            }
        }

        .result-card {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 25px;
            border-radius: 16px;
            text-align: center;
            border-top: 4px solid var(--secondary);
            box-shadow: 0 12px 25px rgba(0,0,0,0.08);
            transition: all 0.3s;
        }

        .result-card:hover {
            transform: scale(1.01);
            box-shadow: 0 18px 35px rgba(0,0,0,0.12);
        }

        .result-card h4 {
            color: var(--primary);
            margin-bottom: 12px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            -webkit-font-smoothing: antialiased;
        }

        .card-value {
            font-size: 2.2rem;
            font-weight: 700;
            color: var(--secondary);
            margin: 12px 0;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.1);
            -webkit-font-smoothing: antialiased;
        }

        .card-label {
            color: #666;
            font-size: 0.9rem;
            -webkit-font-smoothing: antialiased;
        }

        .cutoff-section {
            background: linear-gradient(135deg, #e8f4fc, #d6eaf8);
            padding: 25px;
            border-radius: 16px;
            margin: 25px 0;
            border-left: 6px solid var(--secondary);
            box-shadow: 0 12px 25px rgba(52, 152, 219, 0.15);
            transition: all 0.3s;
        }

        .cutoff-section:hover {
            box-shadow: 0 20px 40px rgba(52, 152, 219, 0.2);
        }

        .cutoff-section h4 {
            color: var(--primary);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1.2rem;
            -webkit-font-smoothing: antialiased;
        }

        .cutoff-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 8px 18px rgba(0, 0, 0, 0.1);
            font-size: 0.9rem;
        }

        .cutoff-table th {
            background: var(--primary);
            color: white;
            padding: 14px;
            text-align: center;
            font-weight: 600;
            font-size: 1rem;
            -webkit-font-smoothing: antialiased;
        }

        .cutoff-table td {
            padding: 14px;
            text-align: center;
            border-bottom: 1px solid #eee;
            -webkit-font-smoothing: antialiased;
        }

        .cutoff-table tr:hover {
            background: #f9f9f9;
        }

        .cutoff-value {
            font-weight: 700;
            color: var(--primary);
        }

        .your-cutoff {
            background: rgba(52, 152, 219, 0.1);
            font-weight: 700;
        }

        .cutoff-diff {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: 600;
            margin-left: 4px;
            -webkit-font-smoothing: antialiased;
        }

        .graph-section {
            margin-top: 40px;
            background: white;
            padding: 30px;
            border-radius: 20px;
            border: 1px solid #e0e0e0;
            box-shadow: 0 15px 30px rgba(0,0,0,0.12);
            transition: all 0.3s;
        }

        .graph-section:hover {
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .graph-header h3 {
            color: var(--primary);
            font-size: 1.3rem;
            margin-bottom: 8px;
            -webkit-font-smoothing: antialiased;
        }

        .graph-header p {
            color: #666;
            font-size: 0.9rem;
            -webkit-font-smoothing: antialiased;
        }

        .graph-container {
            height: 400px;
            position: relative;
        }

        .graph-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .graph-control-btn {
            padding: 10px 20px;
            background: #f0f0f0;
            border: 1px solid #ddd;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
            box-shadow: 0 3px 8px rgba(0,0,0,0.08);
            -webkit-font-smoothing: antialiased;
        }

        .graph-control-btn:hover {
            background: #e0e0e0;
            transform: scale(1.02);
            box-shadow: 0 6px 15px rgba(0,0,0,0.1);
        }

        .graph-control-btn.active {
            background: var(--secondary);
            color: white;
            border-color: var(--secondary);
        }

        .share-buttons {
            display: flex;
            gap: 15px;
            margin: 30px 0;
            justify-content: center;
            flex-wrap: wrap;
        }

        .share-btn {
            padding: 12px 25px;
            border-radius: 30px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 8px 18px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            -webkit-font-smoothing: antialiased;
            font-size: 0.9rem;
        }

        .share-btn:hover {
            transform: scale(1.03);
            box-shadow: 0 12px 25px rgba(0,0,0,0.15);
        }

        .save-btn {
            background: linear-gradient(135deg, #27ae60, #219653);
            color: white;
        }

        .share-whatsapp {
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white;
        }

        .share-download {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }

        footer {
            background: linear-gradient(135deg, var(--primary), #1a2634);
            color: white;
            padding: 30px 40px;
            margin-top: 40px;
            text-align: center;
            border-top: 2px solid rgba(255,255,255,0.1);
        }

        .footer-content h3 {
            font-size: 1.3rem;
            margin-bottom: 8px;
            -webkit-font-smoothing: antialiased;
        }

        .footer-content p {
            opacity: 0.9;
            font-size: 0.95rem;
            -webkit-font-smoothing: antialiased;
        }

        .copyright {
            opacity: 0.95;
            font-size: 1rem;
            margin-top: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            -webkit-font-smoothing: antialiased;
        }

        .developer-badge {
            background: linear-gradient(135deg, var(--secondary), #2980b9);
            padding: 10px 20px;
            border-radius: 30px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-top: 10px;
            box-shadow: 0 8px 20px rgba(52, 152, 219, 0.3);
            transition: all 0.3s;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .developer-badge:hover {
            transform: scale(1.02);
            box-shadow: 0 15px 30px rgba(52, 152, 219, 0.4);
        }

        .developer-icon {
            color: white;
            font-size: 1rem;
        }

        .developer-name {
            color: white;
            font-weight: 700;
            font-size: 1rem;
            -webkit-font-smoothing: antialiased;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 30px;
        }

        .loading i {
            font-size: 3rem;
            color: var(--secondary);
            margin-bottom: 20px;
            animation: spin 1.5s linear infinite;
            filter: drop-shadow(0 8px 12px rgba(52, 152, 219, 0.2));
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading p {
            color: var(--primary);
            font-size: 1rem;
            font-weight: 600;
            -webkit-font-smoothing: antialiased;
        }

        .marks-summary {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 16px;
            margin: 25px 0;
            box-shadow: 0 8px 18px rgba(0,0,0,0.08);
        }

        @media (max-width: 600px) {
            .marks-summary {
                grid-template-columns: 1fr;
            }
        }

        .summary-item {
            text-align: center;
            padding: 16px;
            background: white;
            border-radius: 12px;
            border: 1px solid #e0e0e0;
            box-shadow: 0 5px 12px rgba(0,0,0,0.06);
            transition: all 0.3s;
        }

        .summary-item:hover {
            transform: scale(1.01);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .summary-value {
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--primary);
            margin: 6px 0;
            -webkit-font-smoothing: antialiased;
        }

        .summary-label {
            color: #666;
            font-size: 0.85rem;
            -webkit-font-smoothing: antialiased;
        }

        .note-box {
            background: #fff8e1;
            padding: 16px;
            border-radius: 10px;
            margin-top: 16px;
            font-size: 0.9rem;
            border-left: 4px solid var(--warning);
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            line-height: 1.5;
        }

        .note-box p {
            color: #555;
            -webkit-font-smoothing: antialiased;
        }

        .note-box i {
            color: var(--warning);
            margin-right: 6px;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            body {
                padding: 8px;
            }

            .main-content {
                padding: 20px;
            }

            .predict-btn, .check-again-btn {
                padding: 14px 28px;
                font-size: 1.1rem;
            }

            .card-value {
                font-size: 1.8rem;
            }

            header {
                padding: 18px;
            }

            .cutoff-table {
                font-size: 0.85rem;
            }

            .cutoff-table th, .cutoff-table td {
                padding: 10px;
            }

            .share-buttons {
                flex-direction: column;
                align-items: center;
            }

            .share-btn {
                width: 100%;
                max-width: 280px;
                justify-content: center;
            }
        }

        html {
            scroll-behavior: smooth;
        }

        body, button, input, select, textarea, h1, h2, h3, h4, h5, h6, p, span, div {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            text-rendering: optimizeLegibility;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <div class="logo">
                <i class="fas fa-graduation-cap"></i>
                <div>
                    <h1>GATE RANK <span>PREDICTOR</span> 2026</h1>
                    <p class="subtitle">Predict Your Rank, Score & IIT/PSU Chances Instantly</p>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Input Section -->
            <div class="input-section">
                <div class="section-toggle">
                    <h2><i class="fas fa-edit"></i> SELECT YOUR PAPER</h2>
                </div>
                
                <div class="input-fields" id="inputFields">
                    <div class="input-group">
                        <label><i class="fas fa-file-alt"></i> Select Your Paper</label>
                        <select id="paper">
                            <option value="CS" selected>Computer Science (CS)</option>
                            <option value="CE">Civil Engineering (CE)</option>
                            <option value="ME">Mechanical Engineering (ME)</option>
                            <option value="EE">Electrical Engineering (EE)</option>
                            <option value="ECE">Electronics & Communication (ECE)</option>
                            <option value="DA">Data Science & AI (DA)</option>
                            <option value="IN">Instrumentation Engineering (IN)</option>
                            <option value="PI">Production & Industrial Engg (PI)</option>
                            <option value="XE">Engineering Sciences (XE)</option>
                            <option value="ES">Environmental Science (ES)</option>
                            <option value="CH">Chemical Engineering (CH)</option>
                        </select>
                    </div>

                    <div class="marks-type">
                        <h4><i class="fas fa-1"></i> Type 1 Questions (1 Mark Each) - Total 30 Questions</h4>
                        <div class="marks-grid">
                            <div class="input-group">
                                <label>Correct Answers</label>
                                <input type="number" id="type1Correct" min="0" max="30" step="1" value="" placeholder="Enter correct answers" oninput="updateMarks()">
                                <div class="quick-buttons">
                                    <button class="quick-btn" onclick="setValue('type1Correct', 20, event)">20</button>
                                    <button class="quick-btn" onclick="setValue('type1Correct', 25, event)">25</button>
                                    <button class="quick-btn" onclick="setValue('type1Correct', 28, event)">28</button>
                                </div>
                            </div>
                            <div class="input-group">
                                <label>Wrong Answers</label>
                                <input type="number" id="type1Wrong" min="0" max="30" step="1" value="" placeholder="Enter wrong answers" oninput="updateMarks()">
                                <div class="quick-buttons">
                                    <button class="quick-btn" onclick="setValue('type1Wrong', 0, event)">0</button>
                                    <button class="quick-btn" onclick="setValue('type1Wrong', 3, event)">3</button>
                                    <button class="quick-btn" onclick="setValue('type1Wrong', 5, event)">5</button>
                                </div>
                            </div>
                        </div>
                        <div style="margin-top: 8px; font-size: 0.85rem; color: #666;">
                            <i class="fas fa-info-circle"></i> Total 1-mark questions: <span id="type1Total">0</span>/30
                        </div>
                    </div>

                    <div class="marks-type">
                        <h4><i class="fas fa-2"></i> Type 2 Questions (2 Marks Each) - Total 35 Questions</h4>
                        <div class="marks-grid">
                            <div class="input-group">
                                <label>Correct Answers</label>
                                <input type="number" id="type2Correct" min="0" max="35" step="1" value="" placeholder="Enter correct answers" oninput="updateMarks()">
                                <div class="quick-buttons">
                                    <button class="quick-btn" onclick="setValue('type2Correct', 15, event)">15</button>
                                    <button class="quick-btn" onclick="setValue('type2Correct', 20, event)">20</button>
                                    <button class="quick-btn" onclick="setValue('type2Correct', 25, event)">25</button>
                                </div>
                            </div>
                            <div class="input-group">
                                <label>Wrong Answers</label>
                                <input type="number" id="type2Wrong" min="0" max="35" step="1" value="" placeholder="Enter wrong answers" oninput="updateMarks()">
                                <div class="quick-buttons">
                                    <button class="quick-btn" onclick="setValue('type2Wrong', 0, event)">0</button>
                                    <button class="quick-btn" onclick="setValue('type2Wrong', 2, event)">2</button>
                                    <button class="quick-btn" onclick="setValue('type2Wrong', 5, event)">5</button>
                                </div>
                            </div>
                        </div>
                        <div style="margin-top: 8px; font-size: 0.85rem; color: #666;">
                            <i class="fas fa-info-circle"></i> Total 2-mark questions: <span id="type2Total">0</span>/35
                        </div>
                    </div>

                    <!-- Category Selection -->
                    <div class="input-group">
                        <label><i class="fas fa-users"></i> Select Your Category</label>
                        <div class="category-buttons">
                            <button class="category-btn active" onclick="selectCategory('GEN', event)">General</button>
                            <button class="category-btn" onclick="selectCategory('OBC', event)">OBC-NCL</button>
                            <button class="category-btn" onclick="selectCategory('EWS', event)">EWS</button>
                            <button class="category-btn" onclick="selectCategory('SC', event)">SC</button>
                            <button class="category-btn" onclick="selectCategory('ST', event)">ST</button>
                            <button class="category-btn" onclick="selectCategory('PWD', event)">PwD</button>
                        </div>
                        <input type="hidden" id="category" value="GEN">
                    </div>

                    <div class="note-box">
                        <p><i class="fas fa-info-circle"></i> This is your estimated marks, expected score, and predicted rank based on available data and analysis. The actual GATE result may vary according to the official evaluation and calculation by the exam authorities.</p>
                    </div>
                </div>
            </div>

            <!-- Predict Button -->
            <div class="predict-container">
                <button class="predict-btn" onclick="predictRank()">
                    <i class="fas fa-bolt"></i> PREDICT MY RANK & ANALYSIS
                </button>
            </div>

            <!-- Loading Animation -->
            <div class="loading" id="loading">
                <i class="fas fa-spinner"></i>
                <p>Analyzing your marks...</p>
            </div>

            <!-- Results Section -->
            <div class="results-section" id="resultsSection">
                <div class="results-header">
                    <h2><i class="fas fa-chart-line"></i> Your GATE 2026 Prediction Results</h2>
                    <p>Based on available data and analysis</p>
                </div>

                <!-- Share Buttons -->
                <div class="share-buttons">
                    <button class="share-btn save-btn" onclick="saveResult()">
                        <i class="fas fa-save"></i> SAVE RESULT
                    </button>
                    <button class="share-btn share-whatsapp" onclick="shareWhatsApp()">
                        <i class="fab fa-whatsapp"></i> SHARE ON WHATSAPP
                    </button>
                    <button class="share-btn share-download" onclick="downloadResult()">
                        <i class="fas fa-download"></i> DOWNLOAD AS IMAGE
                    </button>
                </div>

                <!-- Qualification Status -->
                <div class="qualification-status" id="qualificationStatus">
                    <!-- Will be populated by JavaScript -->
                </div>

                <!-- Marks Summary -->
                <div class="marks-summary">
                    <div class="summary-item">
                        <div class="summary-label">Type 1 Marks</div>
                        <div class="summary-value" id="type1Marks">0.00</div>
                        <div class="summary-label" id="type1Details">0✓ 0✗</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Type 2 Marks</div>
                        <div class="summary-value" id="type2Marks">0.00</div>
                        <div class="summary-label" id="type2Details">0✓ 0✗</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Total Marks</div>
                        <div class="summary-value" id="totalMarks">0.00</div>
                        <div class="summary-label">Out of 100</div>
                    </div>
                </div>

                <!-- Results Grid -->
                <div class="results-grid">
                    <div class="result-card">
                        <h4><i class="fas fa-trophy"></i> Expected Rank</h4>
                        <div class="card-value" id="predictedRank">--</div>
                        <div class="card-label">All India Rank</div>
                    </div>

                    <div class="result-card">
                        <h4><i class="fas fa-star"></i> GATE Score</h4>
                        <div class="card-value" id="predictedScore">--</div>
                        <div class="card-label">Out of 1000</div>
                    </div>

                    <div class="result-card">
                        <h4><i class="fas fa-percentage"></i> Percentile</h4>
                        <div class="card-value" id="percentile">--</div>
                        <div class="card-label">Approximate</div>
                    </div>

                    <div class="result-card">
                        <h4><i class="fas fa-chart-bar"></i> Rank Range</h4>
                        <div class="card-value" id="rankRange">--</div>
                        <div class="card-label">±15% variation</div>
                    </div>
                </div>

                <!-- IIT Admission Section -->
                <div class="iit-admission" id="iitAdmissionSection">
                    <h4><i class="fas fa-university"></i> IIT Admission Chances (Based on Your Category)</h4>
                    <div id="iitGridContainer">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Analysis Box -->
                <div class="analysis-box">
                    <h4><i class="fas fa-lightbulb"></i> Analysis & Insights</h4>
                    <div class="analysis-text" id="analysisText">
                        Enter your marks and click predict to see detailed analysis...
                    </div>
                </div>

                <!-- PSU Chances Section -->
                <div class="psu-section" id="psuSection">
                    <h4><i class="fas fa-building"></i> PSU Recruitment Chances</h4>
                    <div id="psuGridContainer">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Cutoff Section -->
                <div class="cutoff-section">
                    <h4><i class="fas fa-flag-checkered"></i> GATE 2026 Expected Cutoff Marks (Based on 2022-2025 Trends)</h4>
                    <div id="cutoffTableContainer">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Interactive Graph Section -->
                <div class="graph-section">
                    <div class="graph-header">
                        <h3><i class="fas fa-chart-line"></i> Rank vs Marks Curve</h3>
                        <p>Hover over points to see exact values • Click and drag to zoom • Double-click to reset</p>
                    </div>
                    <div class="graph-container">
                        <canvas id="rankChart"></canvas>
                    </div>
                    <div class="graph-controls">
                        <button class="graph-control-btn active" onclick="setGraphView('all')">All Data</button>
                        <button class="graph-control-btn" onclick="setGraphView('top')">Top 10,000</button>
                        <button class="graph-control-btn" onclick="setGraphView('yourRegion')">Your Region</button>
                        <button class="graph-control-btn" onclick="exportGraph()">Export Graph</button>
                    </div>
                </div>

                <!-- Check Again Button -->
                <div style="text-align: center; margin-top: 25px;">
                    <button class="check-again-btn" onclick="checkAgain()">
                        <i class="fas fa-redo"></i> CHECK AGAIN WITH DIFFERENT MARKS
                    </button>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer>
            <div class="footer-content">
                <h3>GATE Rank Predictor 2026</h3>
                <p>Predict Your Rank, Score & IIT/PSU Chances Instantly</p>
                <div class="copyright">
                    <i class="fas fa-copyright"></i> 2026 GATE Rank Predictor
                    <div class="developer-badge">
                        <i class="fas fa-code developer-icon"></i>
                        <span class="developer-name">Developed by RAJ BITTU</span>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <script>
        // =====================================================
        // ACTUAL CSE 2025 DATA FROM YOUR IMAGES (UNCHANGED)
        // =====================================================
        
        const cse2025Data = [
            // From 1.jpeg
            { rank: 1, marks: 100.00, score: 1000 },
            { rank: 4, marks: 91.64, score: 985 },
            { rank: 8, marks: 90.75, score: 976 },
            { rank: 12, marks: 89.04, score: 959 },
            { rank: 14, marks: 88.71, score: 956 },
            { rank: 32, marks: 86.11, score: 929 },
            { rank: 38, marks: 85.43, score: 922 },
            { rank: 58, marks: 83.84, score: 906 },
            { rank: 65, marks: 83.51, score: 903 },
            { rank: 130, marks: 79.29, score: 860 },
            { rank: 215, marks: 76.69, score: 833 },
            { rank: 306, marks: 73.57, score: 820 },
            
            // From 2.jpeg
            { rank: 308, marks: 74.38, score: 810 },
            { rank: 336, marks: 73.57, score: 802 },
            { rank: 351, marks: 73.16, score: 797 },
            { rank: 365, marks: 73.11, score: 797 },
            { rank: 416, marks: 71.93, score: 785 },
            { rank: 532, marks: 70.20, score: 767 },
            { rank: 609, marks: 69.21, score: 757 },
            { rank: 622, marks: 69.07, score: 756 },
            { rank: 724, marks: 67.91, score: 744 },
            { rank: 1121, marks: 64.66, score: 711 },
            { rank: 1171, marks: 64.34, score: 708 },
            { rank: 1414, marks: 62.52, score: 689 },
            
            // From 3.jpeg
            { rank: 1445, marks: 62.39, score: 688 },
            { rank: 1605, marks: 58.47, score: 649 },
            { rank: 2434, marks: 56.87, score: 632 },
            { rank: 2498, marks: 56.54, score: 628 },
            { rank: 3466, marks: 52.70, score: 589 },
            { rank: 4135, marks: 50.65, score: 568 },
            { rank: 5620, marks: 46.79, score: 529 },
            { rank: 6600, marks: 44.52, score: 506 },
            { rank: 9288, marks: 40.02, score: 460 },
            { rank: 11184, marks: 37.69, score: 436 },
            { rank: 11318, marks: 37.56, score: 435 },
            { rank: 11517, marks: 37.37, score: 433 },
            { rank: 12652, marks: 36.07, score: 420 },
            { rank: 14720, marks: 34.12, score: 400 },
            { rank: 18757, marks: 31.01, score: 368 },
            { rank: 19661, marks: 30.54, score: 364 },
            { rank: 23003, marks: 28.56, score: 343 },
            { rank: 25003, marks: 27.06, score: 300 },
            { rank: 30003, marks: 25.56, score: 240 },
            { rank: 50003, marks: 22.56, score: 180 },
            { rank: 60003, marks: 20.56, score: 143 },
            { rank: 80003, marks: 15.56, score: 113 },
            { rank: 90003, marks: 5.56, score: 080 }
        ];

        // =====================================================
        // 2024 TOPPER MARKS FOR OTHER BRANCHES (Your Data)
        // =====================================================
        const branchTopper2024 = {
            "CS": 100.00,
            "CE": 89.02,
            "ME": 85.0,
            "EE": 81.67,
            "ECE": 82.67,
            "IN": 79.5,
            "PI": 78.0,
            "DA": 87.0,
            "XE": 76.0,
            "ES": 75.0,
            "CH": 83.0
        };

        // =====================================================
        // 2025 STUDENT COUNTS (as provided)
        // =====================================================
        
        const students2025 = {
            "CS": 170888,
            "CE": 79000,
            "EE": 67700,
            "ECE": 81500,
            "ME": 62000,
            "DA": 60000,
            "IN": 35000,
            "PI": 25000,
            "XE": 20000,
            "ES": 18000,
            "CH": 30000
        };

        // =====================================================
        // 2026 STUDENT COUNTS (realistic projections)
        // =====================================================
        
        const students2026 = {
            "CS": 191395,  // 170888 * 1.12 (12% increase)
            "CE": Math.round(79000 * 1.08),  // 8% increase
            "EE": Math.round(67700 * 1.05),  // 5% increase
            "ECE": Math.round(81500 * 1.07), // 7% increase
            "ME": Math.round(62000 * 1.03),  // 3% increase
            "DA": Math.round(60000 * 1.10),  // 10% increase
            "IN": Math.round(35000 * 1.02),  // 2% increase
            "PI": Math.round(25000 * 1.02),  // 2% increase
            "XE": Math.round(20000 * 1.01),  // 1% increase
            "ES": Math.round(18000 * 1.01),  // 1% increase
            "CH": Math.round(30000 * 1.03)   // 3% increase
        };

        // =====================================================
        // SPECIFIC TARGET VALUES FOR 47 MARKS (Your examples)
        // =====================================================
        
        const targetRanksAt47 = {
            "EE": 670,
            "ECE": 900,
            "ME": 1000,
            "CE": 1200
        };

        const targetScoresAt47 = {
            "EE": 650,
            "ECE": 620,
            "ME": 580,
            "CE": 560
        };

        // =====================================================
        // GENERATE BRANCH-SPECIFIC DATA WITH CORRECT CALIBRATION
        // =====================================================
        
        function generateBranchData(paper) {
            if (paper === "CS") {
                // CS uses original data with 12% competition increase
                return cse2025Data.map(point => ({
                    rank: Math.round(point.rank * 1.12),
                    marks: point.marks,
                    score: point.score
                }));
            }
            
            const topperMarks = branchTopper2024[paper];
            const scaleFactor = topperMarks / 100.0;
            
            // Competition factor relative to CS
            const csStudents2026 = students2026["CS"];
            const branchStudents2026 = students2026[paper];
            const competitionRatio = branchStudents2026 / csStudents2026;
            
            // Start with base CSE data
            const baseData = [...cse2025Data];
            
            // Scale marks to match branch topper
            const scaledData = baseData.map(point => {
                const scaledMarks = point.marks * scaleFactor;
                const scaledScore = Math.round(point.score * scaleFactor * 0.95); // Score slightly lower for non-CS
                
                // Adjust rank based on competition (lower competition = better rank for same marks)
                // Inverse relationship: fewer students = lower rank number
                const rankMultiplier = competitionRatio * 1.2; // Calibration factor
                const adjustedRank = Math.max(1, Math.round(point.rank * rankMultiplier));
                
                return {
                    rank: adjustedRank,
                    marks: parseFloat(scaledMarks.toFixed(2)),
                    score: scaledScore
                };
            });
            
            // Sort by marks descending for proper interpolation
            scaledData.sort((a, b) => b.marks - a.marks);
            
            // Apply specific calibration for target values at 47 marks
            if (targetRanksAt47[paper]) {
                // Find the data point closest to 47 marks and adjust the entire curve
                const targetRank = targetRanksAt47[paper];
                const targetScore = targetScoresAt47[paper];
                
                // Find where 47 marks falls in the scaled data
                let rankAt47 = scaledData.length;
                let scoreAt47 = 0;
                
                for (let i = 0; i < scaledData.length - 1; i++) {
                    if (47 <= scaledData[i].marks && 47 > scaledData[i + 1].marks) {
                        const higher = scaledData[i];
                        const lower = scaledData[i + 1];
                        
                        const marksDiff = higher.marks - lower.marks;
                        const rankDiff = lower.rank - higher.rank;
                        const fraction = (higher.marks - 47) / marksDiff;
                        
                        rankAt47 = Math.round(higher.rank + (fraction * rankDiff));
                        
                        const scoreDiff = lower.score - higher.score;
                        scoreAt47 = Math.round(higher.score + (fraction * scoreDiff));
                        break;
                    }
                }
                
                // Calculate correction factors
                const rankCorrection = targetRank / rankAt47;
                const scoreCorrection = targetScore / scoreAt47;
                
                // Apply corrections to all data points
                return scaledData.map(point => ({
                    rank: Math.max(1, Math.round(point.rank * rankCorrection * 0.98)), // Slight adjustment for smoothness
                    marks: point.marks,
                    score: Math.round(point.score * scoreCorrection * 0.99)
                })).sort((a, b) => a.rank - b.rank);
            }
            
            return scaledData.sort((a, b) => a.rank - b.rank);
        }

        // =====================================================
        // GENERATE DATA FOR ALL BRANCHES
        // =====================================================
        
        const branchRankData = {
            "CS": generateBranchData("CS"),
            "CE": generateBranchData("CE"),
            "ME": generateBranchData("ME"),
            "EE": generateBranchData("EE"),
            "ECE": generateBranchData("ECE"),
            "IN": generateBranchData("IN"),
            "PI": generateBranchData("PI"),
            "DA": generateBranchData("DA"),
            "XE": generateBranchData("XE"),
            "ES": generateBranchData("ES"),
            "CH": generateBranchData("CH")
        };

        // =====================================================
        // GATE 2026 CUTOFFS (Updated based on branch difficulty)
        // =====================================================
        
        const gateCutoffs2026 = {
            "CE": { GEN: "30-32", OBC: "27-29", SC: "20-22", ST: "20-22", PWD: "20-22", EWS: "27-29" },
            "ME": { GEN: "31-33", OBC: "28-30", SC: "21-23", ST: "21-23", PWD: "21-23", EWS: "28-30" },
            "EE": { GEN: "27-29", OBC: "24-26", SC: "18-20", ST: "18-20", PWD: "18-20", EWS: "24-26" },
            "ECE": { GEN: "28-30", OBC: "25-27", SC: "19-21", ST: "19-21", PWD: "19-21", EWS: "25-27" },
            "CS": { GEN: "29-31", OBC: "26-28", SC: "19-21", ST: "19-21", PWD: "19-21", EWS: "26-28" },
            "IN": { GEN: "28-30", OBC: "25-27", SC: "19-21", ST: "19-21", PWD: "19-21", EWS: "25-27" },
            "PI": { GEN: "29-31", OBC: "26-28", SC: "20-22", ST: "20-22", PWD: "20-22", EWS: "26-28" },
            "XE": { GEN: "28-30", OBC: "25-27", SC: "19-21", ST: "19-21", PWD: "19-21", EWS: "25-27" },
            "ES": { GEN: "27-29", OBC: "24-26", SC: "18-20", ST: "18-20", PWD: "18-20", EWS: "24-26" },
            "CH": { GEN: "29-31", OBC: "26-28", SC: "19-21", ST: "19-21", PWD: "19-21", EWS: "26-28" },
            "DA": { GEN: "32-34", OBC: "29-31", SC: "22-24", ST: "22-24", PWD: "22-24", EWS: "29-31" }
        };

        const gateCutoffsMid = {
            "CE": { GEN: 31.0, OBC: 28.0, SC: 21.0, ST: 21.0, PWD: 21.0, EWS: 28.0 },
            "ME": { GEN: 32.0, OBC: 29.0, SC: 22.0, ST: 22.0, PWD: 22.0, EWS: 29.0 },
            "EE": { GEN: 28.0, OBC: 25.0, SC: 19.0, ST: 19.0, PWD: 19.0, EWS: 25.0 },
            "ECE": { GEN: 29.0, OBC: 26.0, SC: 20.0, ST: 20.0, PWD: 20.0, EWS: 26.0 },
            "CS": { GEN: 30.0, OBC: 27.0, SC: 20.0, ST: 20.0, PWD: 20.0, EWS: 27.0 },
            "IN": { GEN: 29.0, OBC: 26.0, SC: 20.0, ST: 20.0, PWD: 20.0, EWS: 26.0 },
            "PI": { GEN: 30.0, OBC: 27.0, SC: 21.0, ST: 21.0, PWD: 21.0, EWS: 27.0 },
            "XE": { GEN: 29.0, OBC: 26.0, SC: 20.0, ST: 20.0, PWD: 20.0, EWS: 26.0 },
            "ES": { GEN: 28.0, OBC: 25.0, SC: 19.0, ST: 19.0, PWD: 19.0, EWS: 25.0 },
            "CH": { GEN: 30.0, OBC: 27.0, SC: 20.0, ST: 20.0, PWD: 20.0, EWS: 27.0 },
            "DA": { GEN: 33.0, OBC: 30.0, SC: 23.0, ST: 23.0, PWD: 23.0, EWS: 30.0 }
        };

        // IIT Admission Marks by Category
        const iitAdmissionRanges = {
            "CS": {
                "GEN": { top: "75-80+", middle: "65-75", lower: "55-65" },
                "OBC": { top: "65-70", middle: "60-65", lower: "50-60" },
                "EWS": { top: "65-70", middle: "60-65", lower: "50-60" },
                "SC": { top: "48-53", middle: "38-48", lower: "30-38" },
                "ST": { top: "45-50", middle: "35-45", lower: "28-35" },
                "PWD": { top: "40-45", middle: "30-40", lower: "25-30" }
            },
            "CE": {
                "GEN": { top: "66-70+", middle: "56-66", lower: "46-56" },
                "OBC": { top: "58-63", middle: "53-58", lower: "43-53" },
                "SC": { top: "42-47", middle: "32-42", lower: "25-32" },
                "ST": { top: "40-45", middle: "30-40", lower: "23-30" },
                "EWS": { top: "58-63", middle: "53-58", lower: "43-53" },
                "PWD": { top: "38-43", middle: "28-38", lower: "22-28" }
            },
            "ME": {
                "GEN": { top: "63-68+", middle: "53-63", lower: "43-53" },
                "OBC": { top: "55-60", middle: "50-55", lower: "40-50" },
                "SC": { top: "40-45", middle: "30-40", lower: "24-30" },
                "ST": { top: "38-43", middle: "28-38", lower: "22-28" },
                "EWS": { top: "55-60", middle: "50-55", lower: "40-50" },
                "PWD": { top: "36-41", middle: "26-36", lower: "21-26" }
            },
            "EE": {
                "GEN": { top: "60-65+", middle: "50-60", lower: "40-50" },
                "OBC": { top: "52-57", middle: "47-52", lower: "37-47" },
                "SC": { top: "38-43", middle: "28-38", lower: "22-28" },
                "ST": { top: "36-41", middle: "26-36", lower: "20-26" },
                "EWS": { top: "52-57", middle: "47-52", lower: "37-47" },
                "PWD": { top: "34-39", middle: "24-34", lower: "19-24" }
            },
            "ECE": {
                "GEN": { top: "61-66+", middle: "51-61", lower: "41-51" },
                "OBC": { top: "53-58", middle: "48-53", lower: "38-48" },
                "SC": { top: "39-44", middle: "29-39", lower: "23-29" },
                "ST": { top: "37-42", middle: "27-37", lower: "21-27" },
                "EWS": { top: "53-58", middle: "48-53", lower: "38-48" },
                "PWD": { top: "35-40", middle: "25-35", lower: "20-25" }
            },
            "DA": {
                "GEN": { top: "65-70+", middle: "55-65", lower: "45-55" },
                "OBC": { top: "57-62", middle: "52-57", lower: "42-52" },
                "SC": { top: "42-47", middle: "32-42", lower: "25-32" },
                "ST": { top: "40-45", middle: "30-40", lower: "23-30" },
                "EWS": { top: "57-62", middle: "52-57", lower: "42-52" },
                "PWD": { top: "38-43", middle: "28-38", lower: "22-28" }
            }
        };

        // PSU Chances Data for all branches
        const psuChancesData = {
            "CS": [
                { marks: "75+", chance: "Very High", companies: "ISRO, DRDO, BARC, BEL, Google, Microsoft" },
                { marks: "65-75", chance: "High", companies: "NTPC, ONGC, GAIL, BHEL, IOCL" },
                { marks: "55-65", chance: "Moderate", companies: "HPCL, BPCL, SAIL, NPCIL" },
                { marks: "45-55", chance: "Low-Moderate", companies: "State PSUs, Power Grid" },
                { marks: "35-45", chance: "Low", companies: "State PSUs, Private Sector" },
                { marks: "25-35", chance: "Very Low", companies: "Private Sector" },
                { marks: "<25", chance: "Unlikely", companies: "Private Sector" }
            ],
            "CE": [
                { marks: "66+", chance: "Very High", companies: "NHAI, NBCC, DRDO, BHEL, L&T" },
                { marks: "56-66", chance: "High", companies: "ONGC, IOCL, GAIL, SAIL" },
                { marks: "46-56", chance: "Moderate", companies: "NTPC, PGCIL, State PSUs" },
                { marks: "36-46", chance: "Low-Moderate", companies: "State PWD, Municipal Corp" },
                { marks: "26-36", chance: "Low", companies: "Private Construction" },
                { marks: "<26", chance: "Unlikely", companies: "Private Sector" }
            ],
            "ME": [
                { marks: "63+", chance: "Very High", companies: "BHEL, DRDO, ISRO, NTPC, L&T" },
                { marks: "53-63", chance: "High", companies: "ONGC, GAIL, SAIL, IOCL" },
                { marks: "43-53", chance: "Moderate", companies: "BPCL, HPCL, NPCIL" },
                { marks: "33-43", chance: "Low-Moderate", companies: "State PSUs, Automotive" },
                { marks: "23-33", chance: "Low", companies: "Private Manufacturing" },
                { marks: "<23", chance: "Unlikely", companies: "Private Sector" }
            ],
            "EE": [
                { marks: "60+", chance: "Very High", companies: "Power Grid, NTPC, BHEL, DRDO" },
                { marks: "50-60", chance: "High", companies: "ONGC, GAIL, IOCL, SAIL" },
                { marks: "40-50", chance: "Moderate", companies: "State Electricity Boards" },
                { marks: "30-40", chance: "Low-Moderate", companies: "Private Power Companies" },
                { marks: "20-30", chance: "Low", companies: "Private Sector" },
                { marks: "<20", chance: "Unlikely", companies: "Private Sector" }
            ],
            "ECE": [
                { marks: "61+", chance: "Very High", companies: "ISRO, DRDO, BARC, BEL" },
                { marks: "51-61", chance: "High", companies: "NTPC, ONGC, GAIL, BHEL" },
                { marks: "41-51", chance: "Moderate", companies: "IOCL, HPCL, BPCL" },
                { marks: "31-41", chance: "Low-Moderate", companies: "Telecom Companies" },
                { marks: "21-31", chance: "Low", companies: "Private Electronics" },
                { marks: "<21", chance: "Unlikely", companies: "Private Sector" }
            ],
            "DA": [
                { marks: "65+", chance: "Very High", companies: "ISRO, DRDO, BARC, Google, Microsoft" },
                { marks: "55-65", chance: "High", companies: "NTPC, ONGC, GAIL, BHEL" },
                { marks: "45-55", chance: "Moderate", companies: "IOCL, HPCL, BPCL" },
                { marks: "35-45", chance: "Low-Moderate", companies: "State PSUs" },
                { marks: "25-35", chance: "Low", companies: "Private Sector" },
                { marks: "<25", chance: "Unlikely", companies: "Private Sector" }
            ]
        };

        // Set default PSU data for remaining branches
        psuChancesData["IN"] = psuChancesData["EE"];
        psuChancesData["PI"] = psuChancesData["ME"];
        psuChancesData["XE"] = psuChancesData["ME"];
        psuChancesData["ES"] = psuChancesData["CE"];
        psuChancesData["CH"] = psuChancesData["CE"];

        let rankChart = null;
        let currentCategory = 'GEN';
        let currentPredictionData = null;
        let currentGraphView = 'all';

        // Select category function
        function selectCategory(category, event) {
            currentCategory = category;
            document.getElementById('category').value = category;
            
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            updateMarks();
        }

        // Set value helper
        function setValue(elementId, value, event) {
            const inputElement = document.getElementById(elementId);
            const otherElementId = elementId.includes('Correct') ? 
                                  elementId.replace('Correct', 'Wrong') : 
                                  elementId.replace('Wrong', 'Correct');
            const otherElement = document.getElementById(otherElementId);
            
            const totalLimit = elementId.includes('type1') ? 30 : 35;
            const currentOtherValue = parseInt(otherElement.value) || 0;
            const newTotal = currentOtherValue + value;
            
            if (newTotal > totalLimit) {
                const excess = newTotal - totalLimit;
                otherElement.value = Math.max(0, currentOtherValue - excess);
                inputElement.value = value;
            } else {
                inputElement.value = value;
            }
            
            const parentDiv = inputElement.closest('.input-group');
            if (parentDiv) {
                parentDiv.querySelectorAll('.quick-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
            }
            
            if (event && event.target) {
                event.target.classList.add('active');
            }
            
            updateMarks();
        }

        // Update marks calculation
        function updateMarks() {
            const type1Correct = parseInt(document.getElementById('type1Correct').value) || 0;
            const type1Wrong = parseInt(document.getElementById('type1Wrong').value) || 0;
            const type2Correct = parseInt(document.getElementById('type2Correct').value) || 0;
            const type2Wrong = parseInt(document.getElementById('type2Wrong').value) || 0;
            
            const type1Total = type1Correct + type1Wrong;
            const type2Total = type2Correct + type2Wrong;
            
            document.getElementById('type1Total').textContent = type1Total;
            document.getElementById('type2Total').textContent = type2Total;
            
            if (type1Total > 30) {
                document.getElementById('type1Total').style.color = 'var(--danger)';
                document.getElementById('type1Total').style.fontWeight = 'bold';
            } else {
                document.getElementById('type1Total').style.color = '#666';
                document.getElementById('type1Total').style.fontWeight = 'normal';
            }
            
            if (type2Total > 35) {
                document.getElementById('type2Total').style.color = 'var(--danger)';
                document.getElementById('type2Total').style.fontWeight = 'bold';
            } else {
                document.getElementById('type2Total').style.color = '#666';
                document.getElementById('type2Total').style.fontWeight = 'normal';
            }
            
            const type1Marks = type1Correct - (type1Wrong * 0.33);
            const type2Marks = (type2Correct * 2) - (type2Wrong * 0.67);
            const totalMarks = type1Marks + type2Marks;
            
            document.getElementById('type1Marks').textContent = type1Marks.toFixed(2);
            document.getElementById('type2Marks').textContent = type2Marks.toFixed(2);
            document.getElementById('totalMarks').textContent = totalMarks.toFixed(2);
            document.getElementById('type1Details').textContent = `${type1Correct}✓ ${type1Wrong}✗`;
            document.getElementById('type2Details').textContent = `${type2Correct}✓ ${type2Wrong}✗`;
            
            document.getElementById('resultsSection').classList.remove('visible');
        }

        // Calculate rank from marks using interpolation
        function calculateRankFromMarks(marks, paper) {
            const data = branchRankData[paper] || branchRankData["CS"];
            const totalCandidates = students2026[paper] || students2026["CS"];
            
            // Sort data by marks descending
            const sortedData = [...data].sort((a, b) => b.marks - a.marks);
            
            // Handle edge cases
            if (marks <= 0) return totalCandidates;
            if (marks >= sortedData[0].marks) return 1;
            
            // Find where marks falls in the data
            for (let i = 0; i < sortedData.length - 1; i++) {
                if (marks <= sortedData[i].marks && marks > sortedData[i + 1].marks) {
                    const higher = sortedData[i];
                    const lower = sortedData[i + 1];
                    
                    // Linear interpolation formula
                    const marksDiff = higher.marks - lower.marks;
                    const rankDiff = lower.rank - higher.rank;
                    const fraction = (higher.marks - marks) / marksDiff;
                    
                    return Math.round(higher.rank + (fraction * rankDiff));
                }
            }
            
            // If marks is below all data points, return last rank
            return totalCandidates;
        }

        // Calculate GATE score using branch-specific data
        function calculateScoreFromMarks(marks, paper) {
            const data = branchRankData[paper] || branchRankData["CS"];
            
            if (marks <= 0) return 0;
            if (marks >= data[0].marks) return data[0].score;
            
            // Find where marks falls in the data
            for (let i = 0; i < data.length - 1; i++) {
                if (marks <= data[i].marks && marks > data[i + 1].marks) {
                    const higher = data[i];
                    const lower = data[i + 1];
                    
                    // Linear interpolation for score
                    const marksDiff = higher.marks - lower.marks;
                    const scoreDiff = lower.score - higher.score;
                    const fraction = (higher.marks - marks) / marksDiff;
                    
                    return Math.round(higher.score + (fraction * scoreDiff));
                }
            }
            
            // If marks is below all data points, extrapolate
            const lastPoint = data[data.length - 1];
            return Math.max(0, Math.round(lastPoint.score * (marks / lastPoint.marks)));
        }

        // Calculate percentile
        function calculatePercentile(rank, paper) {
            const totalCandidates = students2026[paper] || students2026["CS"];
            if (rank <= 0) return 99.99;
            if (rank >= totalCandidates) return 0.01;
            
            const percentile = ((totalCandidates - rank) / totalCandidates) * 100;
            return Math.min(99.99, Math.max(0.01, percentile.toFixed(2)));
        }

        // Get cutoff for selected paper and category
        function getCutoff(paper, category) {
            const cutoffData = gateCutoffsMid[paper];
            if (!cutoffData) return 30.0;
            return cutoffData[category] || 30.0;
        }

        // Create IIT Admission Grid
        function createIITAdmissionGrid(paper, category, userMarks) {
            const paperData = iitAdmissionRanges[paper] || iitAdmissionRanges["CS"];
            const ranges = paperData[category] || paperData["GEN"];
            
            const iitTypes = [
                { name: "Top IITs", desc: "IIT Bombay, Delhi, Madras, Kanpur, Kharagpur", marks: ranges.top },
                { name: "Mid IITs", desc: "IIT Roorkee, Guwahati, Hyderabad, Indore", marks: ranges.middle },
                { name: "New IITs", desc: "IIT Patna, Mandi, Jodhpur, Gandhinagar, Ropar", marks: ranges.lower }
            ];
            
            let html = '<div class="iit-grid">';
            
            iitTypes.forEach(iit => {
                const marksRange = iit.marks;
                let isPossible = false;
                
                if (marksRange.includes('+')) {
                    const minMark = parseInt(marksRange.replace('+', ''));
                    isPossible = userMarks >= minMark;
                } else if (marksRange.includes('-')) {
                    const [minMark, maxMark] = marksRange.split('-').map(m => parseInt(m));
                    isPossible = userMarks >= minMark;
                } else {
                    isPossible = userMarks >= parseInt(marksRange);
                }
                
                html += `
                    <div class="iit-card" style="${isPossible ? 'border-top-color: var(--success);' : ''}">
                        <h5>${iit.name}</h5>
                        <div class="iit-marks">${iit.marks}</div>
                        <div class="iit-type">${iit.desc}</div>
                        <div style="margin-top: 8px; font-size: 0.85rem; ${isPossible ? 'color: var(--success); font-weight: 600;' : 'color: #666;'}">
                            ${isPossible ? '✅ Possible' : '❌ Challenging'}
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            
            const cutoffRange = gateCutoffs2026[paper]?.[category] || "25-30";
            html += `<p style="margin-top: 12px; color: #0e6251; font-size: 0.9rem; text-align: center;">
                <i class="fas fa-info-circle"></i> <strong>Your Category Cutoff (2026):</strong> ${cutoffRange} marks
            </p>`;
            
            return html;
        }

        // Create PSU Chances Grid
        function createPSUChancesGrid(paper, userMarks) {
            const psuData = psuChancesData[paper] || psuChancesData["CS"];
            let userChance = "Unlikely";
            let userCompanies = "Private Sector";
            
            psuData.forEach(item => {
                const marksRange = item.marks;
                if (marksRange.includes('+')) {
                    const minMark = parseFloat(marksRange.replace('+', ''));
                    if (userMarks >= minMark) {
                        userChance = item.chance;
                        userCompanies = item.companies;
                    }
                } else if (marksRange.includes('<')) {
                    const maxMark = parseFloat(marksRange.replace('<', ''));
                    if (userMarks < maxMark) {
                        userChance = item.chance;
                        userCompanies = item.companies;
                    }
                } else {
                    const [minMark, maxMark] = marksRange.split('-').map(m => parseFloat(m));
                    if (userMarks >= minMark && userMarks <= maxMark) {
                        userChance = item.chance;
                        userCompanies = item.companies;
                    }
                }
            });
            
            const chanceColors = {
                "Very High": "#27ae60",
                "High": "#3498db",
                "Moderate": "#f39c12",
                "Low-Moderate": "#f39c12",
                "Low": "#e74c3c",
                "Very Low": "#e74c3c",
                "Unlikely": "#95a5a6"
            };
            
            let html = '<div class="psu-grid">';
            
            psuData.forEach(item => {
                const isUserChance = item.chance === userChance;
                const color = chanceColors[item.chance] || "#95a5a6";
                
                html += `
                    <div class="psu-card" style="${isUserChance ? 'border-top-color: ' + color + '; transform: scale(1.01); box-shadow: 0 4px 12px rgba(0,0,0,0.1);' : 'border-top-color: ' + color + ';'}">
                        <h5>${item.chance}</h5>
                        <div class="psu-chance" style="color: ${color};">${item.marks}</div>
                        <div class="psu-companies">${item.companies}</div>
                        ${isUserChance ? '<div style="margin-top: 4px; color: ' + color + '; font-weight: 600; font-size: 0.75rem;">✓ Your Range</div>' : ''}
                    </div>
                `;
            });
            
            html += '</div>';
            
            html += `
                <div style="margin-top: 18px; padding: 12px; background: white; border-radius: 8px; border-left: 4px solid ${chanceColors[userChance] || '#95a5a6'}; text-align: left;">
                    <h5 style="color: ${chanceColors[userChance] || '#95a5a6'}; margin-bottom: 8px;">Your PSU Recruitment Chance: <strong>${userChance}</strong></h5>
                    <p style="color: #555; margin-bottom: 4px;">🎯 Target Companies: ${userCompanies}</p>
                    <p style="color: #666; font-size: 0.85rem; margin-top: 8px;"><i class="fas fa-info-circle"></i> Based on GATE 2025 PSU recruitment trends</p>
                </div>
            `;
            
            return html;
        }

        // Create cutoff table
        function createCutoffTable(paper, userMarks, userCategory) {
            const cutoffData = gateCutoffs2026[paper] || gateCutoffs2026["CS"];
            
            const categoryMap = { 
                GEN: "General", 
                OBC: "OBC-NCL", 
                EWS: "EWS", 
                SC: "SC", 
                ST: "ST", 
                PWD: "PwD" 
            };
            
            let html = `
                <p><strong>Paper:</strong> ${paper} | <strong>Your Category:</strong> ${categoryMap[userCategory]}</p>
                <table class="cutoff-table">
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>Expected 2026 Cutoff (Range)</th>
                            <th>Mid Value</th>
                            <th>Your Marks</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            for (const [code, name] of Object.entries(categoryMap)) {
                const cutoffRange = cutoffData[code] || "25-30";
                const cutoffMid = gateCutoffsMid[paper]?.[code] || 27.5;
                const isUserCategory = code === userCategory;
                const passes = isUserCategory ? (userMarks >= cutoffMid) : null;
                
                html += `
                    <tr ${isUserCategory ? 'class="your-cutoff"' : ''}>
                        <td><strong>${name}</strong>${isUserCategory ? ' (You)' : ''}</td>
                        <td class="cutoff-value">${cutoffRange}</td>
                        <td class="cutoff-value">${cutoffMid.toFixed(1)}</td>
                        <td class="cutoff-value">${isUserCategory ? userMarks.toFixed(1) : '-'}</td>
                        <td>
                `;
                
                if (isUserCategory) {
                    if (passes) {
                        html += `<span style="background: var(--success); color: white; padding: 2px 6px; border-radius: 10px;"><i class="fas fa-check"></i> QUALIFIED</span>`;
                    } else {
                        html += `<span style="background: var(--danger); color: white; padding: 2px 6px; border-radius: 10px;"><i class="fas fa-times"></i> NOT QUALIFIED</span>`;
                    }
                } else {
                    html += `-`;
                }
                
                html += `</td></tr>`;
            }
            
            html += `</tbody></table>`;
            html += `<p style="margin-top: 8px; font-size: 0.85rem; color: #666;"><i class="fas fa-info-circle"></i> Based on GATE 2022-2025 trends. Actual cutoffs may vary.</p>`;
            
            return html;
        }

        // Get qualification status
        function getQualificationStatus(qualified, userMarks, requiredCutoff, paper, category) {
            const categoryNames = { GEN: "General", OBC: "OBC-NCL", EWS: "EWS", SC: "SC", ST: "ST", PWD: "PwD" };
            const cutoffRange = gateCutoffs2026[paper]?.[category] || "25-30";
            
            const statusDiv = document.getElementById('qualificationStatus');
            
            if (qualified) {
                statusDiv.className = 'qualification-status qualified';
                statusDiv.innerHTML = `
                    <div class="status-icon"><i class="fas fa-check-circle"></i></div>
                    <div class="status-title" style="color: var(--success);">QUALIFIED! 🎉</div>
                    <div class="status-details">
                        <p>Congratulations! You have cleared the GATE 2026 expected cutoff for ${paper} (${categoryNames[category]}).</p>
                        <p><strong>Your Marks:</strong> ${userMarks.toFixed(1)} | <strong>Expected Cutoff Range:</strong> ${cutoffRange}</p>
                        <p>You are above the expected cutoff.</p>
                    </div>
                `;
            } else {
                statusDiv.className = 'qualification-status not-qualified';
                statusDiv.innerHTML = `
                    <div class="status-icon"><i class="fas fa-times-circle"></i></div>
                    <div class="status-title" style="color: var(--danger);">NOT QUALIFIED 😔</div>
                    <div class="status-details">
                        <p>You need to improve your score to clear the GATE 2026 expected cutoff for ${paper} (${categoryNames[category]}).</p>
                        <p><strong>Your Marks:</strong> ${userMarks.toFixed(1)} | <strong>Expected Cutoff Range:</strong> ${cutoffRange}</p>
                        <p>You need approximately <strong>${(requiredCutoff - userMarks + 1).toFixed(1)} more marks</strong> to be safe.</p>
                    </div>
                `;
            }
        }

        // Get analysis text
        function getAnalysisText(rank, marks, score, qualified, paper, category) {
            const categoryName = { GEN: "General", OBC: "OBC-NCL", EWS: "EWS", SC: "SC", ST: "ST", PWD: "PwD" }[category];
            const percentile = calculatePercentile(rank, paper);
            const totalCandidates = students2026[paper] || students2026["CS"];
            
            let analysis = '';
            
            if (category === 'SC' || category === 'ST') {
                analysis = `<span class="good">SC/ST Category:</span> Your marks: ${marks.toFixed(1)} | Category cutoff range: ${gateCutoffs2026[paper]?.[category] || "19-21"}<br><br>`;
            } else if (category === 'OBC' || category === 'EWS') {
                analysis = `<span class="good">OBC/EWS Category:</span> Your marks: ${marks.toFixed(1)} | Category cutoff range: ${gateCutoffs2026[paper]?.[category] || "26-28"}<br><br>`;
            }
            
            if (qualified) {
                if (rank <= 100) {
                    analysis += `<span class="excellent">Outstanding! Rank ${rank.toLocaleString()} (top 0.1%) - Excellent chances for top IITs with your dream branch.</span>`;
                } else if (rank <= 500) {
                    analysis += `<span class="excellent">Excellent! Rank ${rank.toLocaleString()} (top 0.5%) - Very strong chances for top IITs.</span>`;
                } else if (rank <= 1000) {
                    analysis += `<span class="excellent">Great! Rank ${rank.toLocaleString()} (top 1%) - Good chances for top IITs.</span>`;
                } else if (rank <= 5000) {
                    analysis += `<span class="good">Good! Rank ${rank.toLocaleString()} (top 5%) - Good chances for IITs/NITs.</span>`;
                } else if (rank <= 10000) {
                    analysis += `<span class="good">Decent! Rank ${rank.toLocaleString()} (top 10%) - Consider NITs/IIITs/GFTIs.</span>`;
                } else if (rank <= 20000) {
                    analysis += `<span class="average">Qualified! Rank ${rank.toLocaleString()} (top 20%) - Look for NITs/State Universities.</span>`;
                } else if (rank <= 50000) {
                    analysis += `<span class="average">Qualified! Rank ${rank.toLocaleString()} (top 40%) - Consider State Colleges/Universities.</span>`;
                } else {
                    analysis += `<span class="average">Qualified! Consider applying to various universities and colleges.</span>`;
                }
            } else {
                analysis += `<span class="improve">Need to improve. Current marks: ${marks.toFixed(1)} (Required: ${gateCutoffs2026[paper]?.[category] || "25-30"})</span>`;
            }
            
            analysis += `<br><br><strong>Your Statistics:</strong><br>`;
            analysis += `📊 Marks: ${marks.toFixed(2)}/100<br>`;
            analysis += `🏆 Rank: ${rank.toLocaleString()} out of ${totalCandidates.toLocaleString()}<br>`;
            analysis += `📈 Percentile: ${percentile}%<br>`;
            analysis += `⭐ GATE Score: ${score}<br>`;
            
            return analysis;
        }

        // Update chart
        function updateChart(userMarks, userRank, paper) {
            const ctx = document.getElementById('rankChart').getContext('2d');
            const data = branchRankData[paper] || branchRankData["CS"];
            
            if (rankChart) {
                rankChart.destroy();
            }
            
            rankChart = new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: `Rank vs Marks Curve (${paper})`,
                        data: data.map(d => ({x: d.rank, y: d.marks})),
                        backgroundColor: 'rgba(52, 152, 219, 0.6)',
                        borderColor: 'rgba(52, 152, 219, 1)',
                        borderWidth: 1.5,
                        pointRadius: 4,
                        pointHoverRadius: 6,
                        pointHoverBackgroundColor: 'rgba(52, 152, 219, 0.9)',
                        pointHoverBorderColor: 'white',
                        pointHoverBorderWidth: 1.5,
                        showLine: true,
                        tension: 0.4
                    }, {
                        label: 'Your Position',
                        data: [{x: userRank, y: userMarks}],
                        backgroundColor: 'rgba(231, 76, 60, 1)',
                        borderColor: 'white',
                        borderWidth: 2,
                        pointRadius: 10,
                        pointHoverRadius: 12,
                        pointStyle: 'star',
                        pointHoverBackgroundColor: 'rgba(231, 76, 60, 1)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: `Your Position: Rank ${userRank.toLocaleString()} (${userMarks.toFixed(2)} marks)`,
                            font: {size: 12, weight: 'bold'}
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    if (context.dataset.label === 'Your Position') {
                                        return `🎯 You: Rank ${context.raw.x.toLocaleString()}, Marks: ${context.raw.y.toFixed(2)}`;
                                    }
                                    return `📊 Rank: ${context.raw.x.toLocaleString()}, Marks: ${context.raw.y.toFixed(2)}`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            type: 'linear',
                            position: 'bottom',
                            title: {
                                display: true,
                                text: 'Rank (Lower is Better) →'
                            },
                            reverse: true,
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString();
                                }
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Marks (out of 100) ↑'
                            },
                            min: 0,
                            max: 100
                        }
                    }
                }
            });
        }

        // Graph view control
        function setGraphView(view) {
            currentGraphView = view;
            document.querySelectorAll('.graph-control-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            if (currentPredictionData) {
                updateChart(currentPredictionData.marks, currentPredictionData.rank, currentPredictionData.paper);
            }
        }

        // Export graph
        function exportGraph() {
            const canvas = document.getElementById('rankChart');
            const link = document.createElement('a');
            link.download = `GATE-Rank-Curve-${Date.now()}.png`;
            link.href = canvas.toDataURL('image/png');
            link.click();
        }

        // Save result
        function saveResult() {
            if (!currentPredictionData) {
                alert("Please generate a prediction first!");
                return;
            }
            
            const predictions = JSON.parse(localStorage.getItem('gatePredictions') || '[]');
            currentPredictionData.timestamp = new Date().toISOString();
            currentPredictionData.id = Date.now();
            predictions.push(currentPredictionData);
            
            localStorage.setItem('gatePredictions', JSON.stringify(predictions));
            alert("Result saved successfully!");
        }

        // Share on WhatsApp
        function shareWhatsApp() {
            if (!currentPredictionData) {
                alert("Please generate a prediction first!");
                return;
            }
            
            const { paper, category, marks, rank, score, percentile, qualified } = currentPredictionData;
            
            const message = `📊 *My GATE 2026 Prediction Results*%0A%0A` +
                `📝 Paper: ${paper} (${category})%0A` +
                `📊 Marks: ${marks.toFixed(2)}/100%0A` +
                `🏆 Expected Rank: ${rank.toLocaleString()}%0A` +
                `⭐ GATE Score: ${score}%0A` +
                `📈 Percentile: ${percentile}%%0A` +
                `✅ Qualification: ${qualified ? "PASSED ✓" : "NOT QUALIFIED ✗"}%0A%0A` +
                `🔗 Check your prediction at: ${window.location.href}%0A%0A` +
                `#GATE2026 #GATEPrediction #${paper}`;
            
            const whatsappUrl = `https://wa.me/?text=${message}`;
            window.open(whatsappUrl, '_blank');
        }

        // Download as Image
        function downloadResult() {
            const resultsSection = document.getElementById('resultsSection');
            
            html2canvas(resultsSection, {
                scale: 2,
                backgroundColor: '#ffffff',
                useCORS: true
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = `GATE-2026-Prediction-${Date.now()}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
            }).catch(error => {
                console.error('Error capturing image:', error);
                alert('Could not capture image. Please try again.');
            });
        }

        // Check again
        function checkAgain() {
            document.getElementById('resultsSection').classList.remove('visible');
            document.getElementById('loading').style.display = 'none';
            
            const inputSection = document.querySelector('.input-section');
            if (inputSection) {
                inputSection.scrollIntoView({ behavior: 'smooth' });
            }
        }

        // Main prediction function
        function predictRank() {
            const type1Correct = parseInt(document.getElementById('type1Correct').value) || 0;
            const type1Wrong = parseInt(document.getElementById('type1Wrong').value) || 0;
            const type2Correct = parseInt(document.getElementById('type2Correct').value) || 0;
            const type2Wrong = parseInt(document.getElementById('type2Wrong').value) || 0;
            
            const type1Total = type1Correct + type1Wrong;
            const type2Total = type2Correct + type2Wrong;
            
            if (type1Total > 30) {
                alert("Error: Total 1-mark questions cannot exceed 30.");
                return;
            }
            
            if (type2Total > 35) {
                alert("Error: Total 2-mark questions cannot exceed 35.");
                return;
            }
            
            document.getElementById('loading').style.display = 'block';
            document.getElementById('resultsSection').classList.remove('visible');
            
            setTimeout(() => {
                const paper = document.getElementById('paper').value;
                const category = currentCategory;
                
                const type1Marks = type1Correct - (type1Wrong * 0.33);
                const type2Marks = (type2Correct * 2) - (type2Wrong * 0.67);
                const userMarks = type1Marks + type2Marks;
                
                const predictedRank = calculateRankFromMarks(userMarks, paper);
                const predictedScore = calculateScoreFromMarks(userMarks, paper);
                const percentile = calculatePercentile(predictedRank, paper);
                const rankLower = Math.max(1, Math.round(predictedRank * 0.85));
                const rankUpper = Math.min(students2026[paper], Math.round(predictedRank * 1.15));
                
                const requiredCutoff = getCutoff(paper, category);
                const qualified = userMarks >= requiredCutoff;
                
                currentPredictionData = {
                    paper,
                    category,
                    marks: userMarks,
                    rank: predictedRank,
                    score: predictedScore,
                    percentile,
                    qualified,
                    type1Correct,
                    type1Wrong,
                    type2Correct,
                    type2Wrong
                };
                
                document.getElementById('type1Marks').textContent = type1Marks.toFixed(2);
                document.getElementById('type2Marks').textContent = type2Marks.toFixed(2);
                document.getElementById('totalMarks').textContent = userMarks.toFixed(2);
                document.getElementById('type1Details').textContent = `${type1Correct}✓ ${type1Wrong}✗`;
                document.getElementById('type2Details').textContent = `${type2Correct}✓ ${type2Wrong}✗`;
                
                document.getElementById('predictedRank').textContent = predictedRank.toLocaleString();
                document.getElementById('predictedScore').textContent = predictedScore;
                document.getElementById('percentile').textContent = percentile + '%';
                document.getElementById('rankRange').textContent = `${rankLower.toLocaleString()} - ${rankUpper.toLocaleString()}`;
                
                getQualificationStatus(qualified, userMarks, requiredCutoff, paper, category);
                
                document.getElementById('cutoffTableContainer').innerHTML = createCutoffTable(paper, userMarks, category);
                
                document.getElementById('iitGridContainer').innerHTML = createIITAdmissionGrid(paper, category, userMarks);
                
                document.getElementById('psuGridContainer').innerHTML = createPSUChancesGrid(paper, userMarks);
                
                document.getElementById('analysisText').innerHTML = getAnalysisText(predictedRank, userMarks, predictedScore, qualified, paper, category);
                
                updateChart(userMarks, predictedRank, paper);
                
                document.getElementById('loading').style.display = 'none';
                document.getElementById('resultsSection').classList.add('visible');
                
                document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth' });
            }, 800);
        }

        // Initialize
        window.addEventListener('DOMContentLoaded', function() {
            document.getElementById('type1Correct').setAttribute('max', 30);
            document.getElementById('type1Wrong').setAttribute('max', 30);
            document.getElementById('type2Correct').setAttribute('max', 35);
            document.getElementById('type2Wrong').setAttribute('max', 35);
            
            document.getElementById('type1Correct').value = '';
            document.getElementById('type1Wrong').value = '';
            document.getElementById('type2Correct').value = '';
            document.getElementById('type2Wrong').value = '';
            
            updateMarks();
            document.getElementById('resultsSection').classList.remove('visible');
        });
    </script>
</body>
</html>
